# 工具栏隐藏/显示功能

## 功能概述

为了解决手机截图时底部工具栏被截入的问题，实现了工具栏隐藏/显示功能，让用户可以在截图前隐藏工具栏，获得干净的截图效果。

## 交互方案

### 1. **双击屏幕切换** ✅ 唯一方式
- **操作**：双击屏幕任意空白区域
- **功能**：切换工具栏显示/隐藏状态
- **优点**：快速、直观、不干扰正常交互、界面简洁
- **实现**：智能检测，避免与标签点击、按钮点击冲突
- **提示**：首次隐藏时显示"💡 双击屏幕可切换工具栏显示"

### 2. **首次隐藏提示** ✅ 已实现
- **显示时机**：第一次隐藏工具栏时
- **内容**：💡 双击屏幕可切换工具栏显示
- **自动隐藏**：3秒后自动消失
- **可点击关闭**：用户可点击提前关闭

## 技术实现

### 状态管理
```javascript
const isToolbarHidden = ref(false)  // 工具栏隐藏状态
const showScreenshotHint = ref(false)  // 截图提示显示状态
```

### 核心函数
```javascript
// 双击检测切换工具栏
const handleScreenTap = (e) => {
  // 智能检测双击，避免与可交互元素冲突
  // 使用 hasOtherInteraction 标记避免误触
}

const toggleToolbar = () => {
  // 切换工具栏显示/隐藏
  // 首次隐藏时显示提示
  // 自动调整页面padding
}

// 设置交互标记，避免双击误触
const setInteractionFlag = () => {
  // 标记有交互发生，防止双击检测触发
}
```

### 样式实现
- **工具栏动画**：使用 `transform: translateY()` 实现滑动隐藏
- **页面padding调整**：通过 `.toolbar-hidden` class 自动调整
- **过渡效果**：`transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1)`

## 使用流程

1. **用户想要截图**
   - 双击屏幕任意空白区域
   - 工具栏向下滑动隐藏
   - 显示"💡 双击屏幕可切换工具栏显示"提示

2. **使用手机截图**
   - 工具栏已隐藏，页面内容完整显示
   - 使用手机系统截图功能
   - 获得干净的截图效果

3. **恢复工具栏**
   - 再次双击屏幕任意空白区域
   - 工具栏向上滑动显示

## 设计考虑

### 为什么选择双击屏幕作为主要方式？
1. **快速便捷** - 无需寻找按钮，双击即可切换
2. **不干扰** - 智能检测，不会影响标签点击、按钮点击等正常交互
3. **直观自然** - 双击切换是常见的交互模式
4. **多种方式** - 保留按钮作为备选，满足不同用户习惯

### 如何避免双击干扰正常交互？
1. **交互标记** - 使用 `hasOtherInteraction` 标记，当有标签点击、按钮点击等交互时，不触发双击
2. **事件阻止** - 在可交互元素上使用 `@click.stop` 阻止事件冒泡
3. **延迟检测** - 双击检测延迟50ms执行，给其他事件处理机会
4. **元素判断** - 检查点击目标，如果是可交互元素则不处理

### 为什么添加浮动恢复按钮？
1. **易用性** - 隐藏后容易找到恢复方式
2. **视觉提示** - 明确告知用户可以恢复
3. **快速操作** - 一键恢复，无需滚动

### 为什么添加首次提示？
1. **用户教育** - 告知用户功能用途
2. **降低困惑** - 解释为什么工具栏消失了
3. **引导操作** - 提示可以使用截图功能

## 注意事项

1. **双击功能**：已实现但未在UI上暴露，避免干扰正常交互
2. **动画性能**：使用 transform 而非改变 position，性能更好
3. **安全区域**：考虑了 `env(safe-area-inset-bottom)` 适配
4. **状态持久化**：当前不持久化，每次进入页面都是显示状态

## 未来优化

- [ ] 添加手势滑动隐藏（向上滑动隐藏工具栏）
- [ ] 支持状态持久化（记住用户的偏好）
- [ ] 添加更多切换方式（如长按等）
- [ ] 优化双击检测，在特定区域启用
